/* plugin to create rain effect on a webpage. https://github.com/andysellick/weather */
function weatherObj(a,b){this.el=a,this.dropDarkness=[],this.resize=0,this.settings={dropDensity:"undefined"==typeof b.dropDensity?40:b.dropDensity,dropColor:"undefined"==typeof b.dropColor?[0,0,0]:b.dropColor,speed:"undefined"==typeof b.speed?10:b.speed,wind:"undefined"==typeof b.wind?-5:b.wind,dropDarkness:"undefined"==typeof b.dropDarkness?.5:b.dropDarkness,dropWidth:"undefined"==typeof b.dropWidth?1:b.dropWidth,dropHeight:"undefined"==typeof b.dropHeight?2:b.dropHeight};var c=this;this.functions={canvas:{init:function(){c.functions.general.overrideSettings(),c.functions.canvas.initCanvas(),c.functions.general.initDrops(),c.functions.general.drawloop()},initCanvas:function(){c.canvas=document.createElement("canvas"),c.canvas.className="w-canvas",c.canvas.style.position="absolute",c.canvas.style.top=0,c.canvas.style.left=0,c.el.style.position="relative",c.el.appendChild(c.canvas),c.context=c.canvas.getContext("2d"),c.functions.canvas.initialise()},initialise:function(){c.canvas.width=c.el.offsetWidth,c.canvas.height=c.el.offsetHeight},clearCanvas:function(){c.context.clearRect(0,0,c.canvas.width,c.canvas.height)}},general:{overrideSettings:function(){c.settings.wind>35&&(c.settings.wind=35),c.settings.wind<-35&&(c.settings.wind=-35),(c.settings.dropDarkness>1||c.settings.dropDarkness<0)&&(c.settings.dropDarkness=1),c.settings.dropColor.constructor===Array&&3===c.settings.dropColor.length||(c.settings.dropColor=[0,0,0])},initDrops:function(){var a=c.canvas.width/100*c.settings.dropDensity;c.minstart=-20,c.maxstop=c.canvas.height+20,c.spacing=c.canvas.width/a,c.drops=[];for(var b=0;b<a;b++)c.drops.push([c.spacing*b,c.functions.general.randomIntFromInterval(c.minstart,c.maxstop)]);c.dropDarkness.push(c.settings.dropDarkness),c.dropDarkness.push(c.settings.dropDarkness/3*2),c.dropDarkness.push(c.settings.dropDarkness/3)},randomIntFromInterval:function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},resizeWindow:function(){c.functions.canvas.initialise(),c.functions.general.initDrops()},drawloop:function(){c.functions.canvas.clearCanvas();for(var a=.2,b=0,d=0;d<c.drops.length;d++)c.drops[d][1]=c.drops[d][1]+c.settings.speed+10*a,c.drops[d][1]>c.maxstop&&(c.drops[d][1]=c.minstart),c.context.save(),c.context.fillStyle="rgba("+c.settings.dropColor[0]+","+c.settings.dropColor[1]+","+c.settings.dropColor[2]+","+c.dropDarkness[b]+")",c.settings.wind?(c.drops[d][0]+=c.settings.wind/2,c.drops[d][0]>c.canvas.width&&(c.drops[d][0]=0),c.drops[d][0]<0&&(c.drops[d][0]=c.canvas.width),c.context.translate(c.drops[d][0],c.drops[d][1]),c.context.rotate(-c.settings.wind*Math.PI/90),c.context.fillRect(0,0,c.settings.dropWidth,c.settings.dropHeight+8*a)):c.context.fillRect(c.drops[d][0],c.drops[d][1],c.settings.dropWidth,c.settings.dropHeight+8*a),c.context.restore(),a+=.2,a>1&&(a=.2),b+=1,b>=c.dropDarkness.length&&(b=0);setTimeout(c.functions.general.drawloop,40)}}},window.addEventListener("load",function(){c.functions.canvas.init()},!1),window.addEventListener("resize",function(){clearTimeout(c.resize),c.resize=setTimeout(c.functions.general.resizeWindow,200)},!1)}